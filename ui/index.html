<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="stylesheet" href="node_modules/@chrisoakman/chessboardjs/dist/chessboard-1.0.0.css">
    <script src="node_modules/jquery/dist/jquery.js"></script>
    <script src="node_modules/@chrisoakman/chessboardjs/dist/chessboard-1.0.0.js"></script>
    <title>Document</title>
  </head>
  <body>
    <div id="Board" style="width: 70%"></div>
  </body>
    <script>
      const { TAURI } = window.__TAURI__.tauri;

        let board = null
        const whiteSquareGrey = '#a9a9a9'
        const blackSquareGrey = '#696969'

        function removeGreySquares () {
            $('#Board .square-55d63').css('background', '')
        }

        function greySquare (square) {
            console.log("greySquare");
            console.log("square   " + square);
            const $square = $('#Board .square-' + square)

            const background = whiteSquareGrey
            if ($square.hasClass('black-3c85d')) {
                background = blackSquareGrey
            }

            $square.css('background', background)
        }

        function onDragStart (source, piece) {
            console.log("onDragStart ");
            console.log("source   " + source)
            console.log("piece   " +piece)
            // do not pick up pieces if the game is over
            /* if (game.game_over()) return false */
            /**/
            /* // or if it's not that side's turn */
            /* if ((game.turn() === 'w' && piece.search(/^b/) !== -1) || */
            /*     (game.turn() === 'b' && piece.search(/^w/) !== -1)) { */
            /*     return false */
            /* } */
        }

        function onDrop (source, target) {
            console.log("onDrop ");
            console.log("source   " + source)
            console.log("target   " +target)
            removeGreySquares()

            // see if the move is legal
            /* var move = game.move({ */
            /*     from: source, */
            /*     to: target, */
            /*     promotion: 'q' // NOTE: always promote to a queen for example simplicity */
            /* }) */

            // illegal move
            if (move === null) return 'snapback'
        }

        function onMouseoverSquare (square, piece) {
            console.log("onMouseoverSquare");
            console.log("square   " + square)
            console.log("piece   " +piece)
            // get list of possible moves for this square
            /* var moves = game.moves({ */
            /*     square: square, */
            /*     verbose: true */
            /* }) */

            // exit if there are no moves available for this square
            if (moves.length === 0) return

            // highlight the square they moused over
            greySquare(square)

            // highlight the possible squares for this piece
            for (var i = 0; i < moves.length; i++) {
                greySquare(moves[i].to)
            }
        }

        function onMouseoutSquare (square, piece) {
            console.log("onMouseoutSquare ");
            console.log("square   " + square)
            console.log("piece   " +piece)
            removeGreySquares()
        }

        function onSnapEnd () {
            //
        }

        const config = {
            draggable: true,
            position: 'start',
            onDragStart: onDragStart,
            onDrop: onDrop,
            onMouseoutSquare: onMouseoutSquare,
            onMouseoverSquare: onMouseoverSquare,
            onSnapEnd: onSnapEnd
        }
        board = Chessboard('Board', config)
</script>
</html>
